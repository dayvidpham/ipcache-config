{
    "groups": {
        "group:helm": [
            "hs0@"
        ],
        "group:exit": [
            "exit@"
        ],
        "group:border": [
            "hs0@",
            "exit@"
        ],
        "group:admin": [
            "minttea@"
        ],
        "group:leaf": [
            "minttea@"
        ]
    },
    // tag: specifies the class or role of a machine
    // tagOwners are groups that can attempt to opt their own machines into having the role
    "tagOwners": {
        "tag:exit": [
            "group:exit",
            "exit@"
        ],
        "tag:builder": [
            "sfurs@",
        ],
        "tag:openclaw-vm": [
            "openclaw@",
        ],
    },
    "autoApprovers": {
        "exitNode": [
            "tag:exit"
        ]
    },
    "acls": [
        // We still have to allow internal users communications since nothing guarantees that each user have
        // their own users.
        {
            "action": "accept",
            "src": [
                "hs0@"
            ],
            "dst": [
                "hs0@:*",
                "minttea@:8108",
                "minttea@:22"
            ]
        },
        {
            "action": "accept",
            "src": [
                "exit@"
            ],
            "dst": [
                "exit@:*"
            ]
        },
        {
            "action": "accept",
            "src": [
                "minttea@"
            ],
            "dst": [
                "minttea@:*",
                "sfurs@:*",
                "openclaw@:*",
                "tag:openclaw-vm:*"
            ]
        },
        {
            "action": "accept",
            "src": [
                "sfurs@"
            ],
            "dst": [
                "sfurs@:*"
            ]
        },
        { // allow pretty much everybody to contact the exit nodes
            // ideally, don't want the tag:internal to do this, but don't even have any internal services yet
            "action": "accept",
            "src": [
                "*"
            ],
            "dst": [
                "autogroup:internet:*"
            ]
        },
        { // allow pretty much everybody to contact the exit nodes
            // ideally, don't want the tag:internal to do this, but don't even have any internal services yet
            "action": "accept",
            "src": [
                "*"
            ],
            "dst": [
                "tag:exit:*"
            ]
        },
        { // allow admins to ping everybody
            "action": "accept",
            "proto": "icmp",
            "src": [
                "group:admin"
            ],
            "dst": [
                "*@:*"
            ]
        },
        { // allow admins to ssh into others
            "action": "accept",
            "src": [
                "group:admin"
            ],
            "dst": [
                "group:border:22",
                "tag:exit:22",
                "hs0@:22",
                "minttea@:22",
                "minttea@:8108",
                "sfurs@:22",
                "sfurs@:9204",
                "tag:openclaw-vm:22",
                "openclaw@:22",
            ]
        },
        { // allow admins to ssh into others
            "action": "accept",
            "src": [
                "minttea@"
            ],
            "dst": [
                "group:border:22",
                "tag:exit:22",
                "hs0@:22",
                "exit@:22",
                "minttea@:22",
                "minttea@:8108",
                "sfurs@:22",
                "sfurs@:9204",
                "tag:openclaw-vm:22",
                "openclaw@:22",
            ]
        }
    ],
    // Tailscale SSH rules â€” interactive access only, no service accounts
    // nix-ssh is intentionally excluded: nix builder uses OpenSSH on port 8108
    "ssh": [
        {
            "action": "accept",
            "src": [
                "group:admin",
                "minttea@"
            ],
            "dst": [
                "hs0@"
            ],
            "users": [
                "app"
            ]
        },
        {
            "action": "accept",
            "src": [
                "group:admin",
                "minttea@"
            ],
            "dst": [
                "tag:exit",
                "exit@"
            ],
            "users": [
                "app"
            ]
        },
        {
            "action": "accept",
            "src": [
                "group:admin",
                "minttea@"
            ],
            "dst": [
                "minttea@"
            ],
            "users": [
                "minttea"
            ]
        },
        {
            "action": "accept",
            "src": [
                "group:admin",
                "minttea@"
            ],
            "dst": [
                "sfurs@"
            ],
            "users": [
                "app",
                "builder"
            ]
        },
        {
            "action": "accept",
            "src": [
                "group:admin",
                "minttea@"
            ],
            "dst": [
                "tag:builder"
            ],
            "users": [
                "builder"
            ]
        },
        {
            "action": "accept",
            "src": [
                "group:admin",
                "minttea@"
            ],
            "dst": [
                "tag:openclaw-vm",
                "openclaw@"
            ],
            "users": [
                "openclaw"
            ]
        },
    ],
}
